{"name":"docker-log-alert","description":"This content pack will create a syslog tcp+tls input and set up extractors for nginx and nginx error logs.","category":"Web Servers","inputs":[{"title":"nginx logs","configuration":{"recv_buffer_size":1048576,"tcp_keepalive":false,"use_null_delimiter":false,"tls_client_auth_cert_file":"","force_rdns":false,"bind_address":"0.0.0.0","tls_cert_file":"/etc/tls/cert.pem","store_full_message":true,"expand_structured_data":false,"port":1514,"tls_key_file":"/etc/tls/key.pem","tls_enable":true,"tls_key_password":"","max_message_size":2097152,"tls_client_auth":"disabled","override_source":null,"allow_override_date":true},"static_fields":{},"type":"org.graylog2.inputs.syslog.tcp.SyslogTCPInput","global":false,"extractors":[{"title":"Remote User","type":"REGEX","cursor_strategy":"COPY","target_field":"remote_user","source_field":"message","configuration":{"regex_value":"^.*]: \\S+ - (\\S+)"},"converters":[],"condition_type":"REGEX","condition_value":"^((?!error).)*$","order":1},{"title":"Remote Address","type":"REGEX","cursor_strategy":"COPY","target_field":"remote_addr","source_field":"message","configuration":{"regex_value":"^.*]:\\s+(\\S+)"},"converters":[],"condition_type":"REGEX","condition_value":"^((?!error).)*$","order":0},{"title":"Request Verb","type":"REGEX","cursor_strategy":"COPY","target_field":"request_verb","source_field":"message","configuration":{"regex_value":"^.*]:.+\\[.+\\] \"(\\S+)"},"converters":[],"condition_type":"REGEX","condition_value":"^((?!error).)*$","order":3},{"title":"HTTP Version","type":"REGEX","cursor_strategy":"COPY","target_field":"http_version","source_field":"message","configuration":{"regex_value":"^.*]:.+HTTP/(\\S+)\""},"converters":[],"condition_type":"REGEX","condition_value":"^((?!error).)*$","order":5},{"title":"HTTP User Agent","type":"REGEX","cursor_strategy":"COPY","target_field":"http_user_agent","source_field":"message","configuration":{"regex_value":"^.*]:.+?HTTP/\\S+\" \\d+ \\d+ \".+?\" \"(.+?)\""},"converters":[],"condition_type":"REGEX","condition_value":"^((?!error).)*$","order":8},{"title":"Request Path","type":"REGEX","cursor_strategy":"COPY","target_field":"request_path","source_field":"message","configuration":{"regex_value":"^.*]:.+?\"\\S+ (\\S+).+\""},"converters":[{"type":"NUMERIC","configuration":{}}],"condition_type":"REGEX","condition_value":"^((?!error).)*$","order":4},{"title":"container_id","type":"REGEX","cursor_strategy":"COPY","target_field":"container_id","source_field":"message","configuration":{"regex_value":"^.*?/.*?/(.*?)\\["},"converters":[],"condition_type":"NONE","condition_value":"","order":0},{"title":"HTTP Referer","type":"REGEX","cursor_strategy":"COPY","target_field":"http_referer","source_field":"message","configuration":{"regex_value":"^.*]:.+?HTTP/\\S+\" \\d+ \\d+ \"(.+?)\""},"converters":[],"condition_type":"REGEX","condition_value":"^((?!error).)*$","order":9},{"title":"Response Status","type":"REGEX","cursor_strategy":"COPY","target_field":"response_status","source_field":"message","configuration":{"regex_value":"^.*]:.+?HTTP/\\S+\" (\\d+)"},"converters":[{"type":"NUMERIC","configuration":{}}],"condition_type":"REGEX","condition_value":"^((?!error).)*$","order":6},{"title":"Response Bytes","type":"REGEX","cursor_strategy":"COPY","target_field":"response_bytes","source_field":"message","configuration":{"regex_value":"^.*]:.+?HTTP/\\S+\" \\d+ (\\d+)"},"converters":[{"type":"NUMERIC","configuration":{}}],"condition_type":"REGEX","condition_value":"^((?!error).)*$","order":7},{"title":"container_name","type":"REGEX","cursor_strategy":"COPY","target_field":"container_name","source_field":"message","configuration":{"regex_value":"^.*?/(.*?)/"},"converters":[],"condition_type":"NONE","condition_value":"","order":0},{"title":"Message","type":"REGEX","cursor_strategy":"COPY","target_field":"message","source_field":"message","configuration":{"regex_value":"nginx:.+?\\\"(\\S+.+HTTP\\/\\S+)\\\" \\d+"},"converters":[],"condition_type":"REGEX","condition_value":"^((?!error).)*$","order":13},{"title":"source","type":"REGEX","cursor_strategy":"COPY","target_field":"source","source_field":"container_name","configuration":{"regex_value":"(.*)"},"converters":[],"condition_type":"NONE","condition_value":"","order":0},{"title":"nginx_error_message","type":"REGEX","cursor_strategy":"COPY","target_field":"nginx_error_message","source_field":"full_message","configuration":{"regex_value":"^.*\\]\\ (.*?),"},"converters":[],"condition_type":"STRING","condition_value":"error","order":0},{"title":"container_image","type":"REGEX","cursor_strategy":"COPY","target_field":"container_image","source_field":"message","configuration":{"regex_value":"^(.*?)/"},"converters":[],"condition_type":"NONE","condition_value":"","order":0},{"title":"nginx_error_timestamp","type":"REGEX","cursor_strategy":"COPY","target_field":"nginx_error_timestamp","source_field":"full_message","configuration":{"regex_value":"^.*:\\ (.*?)\\ \\["},"converters":[],"condition_type":"STRING","condition_value":"error","order":0},{"title":"nginx_error_host","type":"REGEX","cursor_strategy":"COPY","target_field":"nginx_error_host","source_field":"full_message","configuration":{"regex_value":"^.*host:\\ \\\"(.*?)\\\""},"converters":[],"condition_type":"STRING","condition_value":"error","order":0},{"title":"nginx_error_client","type":"REGEX","cursor_strategy":"COPY","target_field":"nginx_error_client","source_field":"full_message","configuration":{"regex_value":"^.*client:\\ (.*?),"},"converters":[],"condition_type":"STRING","condition_value":"error","order":0},{"title":"Request Timestamp","type":"REGEX","cursor_strategy":"COPY","target_field":"timestamp","source_field":"message","configuration":{"regex_value":"^.*]:.+?\\[(.+?)\\]"},"converters":[],"condition_type":"REGEX","condition_value":"^((?!error).)*$","order":2},{"title":"nginx_error_server","type":"REGEX","cursor_strategy":"COPY","target_field":"nginx_error_server","source_field":"full_message","configuration":{"regex_value":"^.*server:\\ (.*?),"},"converters":[],"condition_type":"STRING","condition_value":"error","order":0},{"title":"nginx_error_request","type":"REGEX","cursor_strategy":"COPY","target_field":"nginx_error_request","source_field":"full_message","configuration":{"regex_value":"^.*request:\\ \\\"(.*?)\\\""},"converters":[],"condition_type":"STRING","condition_value":"error","order":0}]}],"streams":[],"outputs":[],"dashboards":[],"grok_patterns":[]}
